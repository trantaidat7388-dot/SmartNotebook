<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.web.HTMLEditor?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.SVGPath?>

<HBox xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.dat.notebook.controller.MainControllerV2" styleClass="main-root" stylesheets="@../css/soft-peach.css" minWidth="900" minHeight="550">

    <!-- ==================== LEFT SIDEBAR (1/5) ==================== -->
    <VBox styleClass="sidebar" minWidth="160" maxWidth="220">
        <!-- Header -->
        <VBox styleClass="sidebar-header" spacing="5">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="ðŸ““" style="-fx-font-size: 28px;"/>
                <VBox>
                    <Label text="SmartNote" styleClass="sidebar-logo"/>
                    <Label text="v2.10 Solid Orange" styleClass="sidebar-version"/>
                </VBox>
            </HBox>
        </VBox>

        <!-- Search -->
        <HBox styleClass="input-container" alignment="CENTER_LEFT" spacing="10">
            <SVGPath content="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" style="-fx-fill: #9ca3af;" scaleX="1.1" scaleY="1.1"/>
            <TextField fx:id="txtSearch" promptText="TÃ¬m kiáº¿m..." styleClass="search-field" HBox.hgrow="ALWAYS"/>
        </HBox>

        <!-- Menu Section -->
        <Label text="KHÃ”NG GIAN LÃ€M VIá»†C" styleClass="sidebar-section-title"/>

        <VBox spacing="8">
            <Button fx:id="btnAllNotes" text="ðŸ“‹  Táº¥t cáº£ ghi chÃº" styleClass="sidebar-btn" onAction="#handleShowAllNotes" maxWidth="Infinity"/>

            <Button fx:id="btnFavorites" styleClass="sidebar-btn" onAction="#handleShowFavorites" maxWidth="Infinity">
                <graphic>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <SVGPath content="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" style="-fx-fill: #FFD700;" scaleX="1.3" scaleY="1.3"/>
                        <Label text="YÃªu thÃ­ch" style="-fx-text-fill: inherit;"/>
                    </HBox>
                </graphic>
            </Button>

            <Button fx:id="btnTrash" text="   ThÃ¹ng rÃ¡c" styleClass="sidebar-btn" onAction="#handleShowTrash" maxWidth="Infinity">
                <graphic>
                    <HBox spacing="5" alignment="CENTER_LEFT">
                        <!-- Trash Icon -->
                        <SVGPath content="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" styleClass="trash-icon-svg" scaleX="1.1" scaleY="1.1"/>
                        <!-- Note Icon (Simulating the user's image) -->
                        <SVGPath content="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" styleClass="trash-icon-svg" scaleX="0.9" scaleY="0.9"/>
                    </HBox>
                </graphic>
            </Button>
        </VBox>

        <!-- Filter by Status -->
        <Label text="Lá»ŒC THEO TRáº NG THÃI" styleClass="sidebar-section-title"/>

        <VBox spacing="5">
            <Button fx:id="btnFilterRegular" text="ðŸ“ ThÆ°á»ng" styleClass="sidebar-btn-small" onAction="#handleFilterRegular" maxWidth="Infinity"/>
            <Button fx:id="btnFilterUrgent" text="ðŸ”´ Kháº©n cáº¥p" styleClass="sidebar-btn-small" onAction="#handleFilterUrgent" maxWidth="Infinity"/>
            <Button fx:id="btnFilterIdeas" text="ðŸ’¡ Ã tÆ°á»Ÿng" styleClass="sidebar-btn-small" onAction="#handleFilterIdeas" maxWidth="Infinity"/>
            <Button fx:id="btnFilterCompleted" text="âœ… HoÃ n thÃ nh" styleClass="sidebar-btn-small" onAction="#handleFilterCompleted" maxWidth="Infinity"/>
        </VBox>

        <!-- Spacer -->
        <Region VBox.vgrow="ALWAYS"/>

        <!-- Bottom Section -->
        <VBox spacing="8">
            <Button fx:id="btnSettings" styleClass="sidebar-btn" onAction="#handleShowSettings" maxWidth="Infinity">
                <graphic>
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <SVGPath content="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" style="-fx-fill: #6b7280;" scaleX="1.1" scaleY="1.1"/>
                        <Label text="CÃ i Ä‘áº·t" style="-fx-text-fill: inherit;"/>
                    </HBox>
                </graphic>
            </Button>

            <Button fx:id="btnLogout" text="ðŸšª  ÄÄƒng xuáº¥t" styleClass="sidebar-btn" onAction="#handleLogout" maxWidth="Infinity"/>

            <!-- User Info -->
            <HBox styleClass="sidebar-user-info" alignment="CENTER_LEFT" spacing="12">
                <Label text="ðŸ‘¤" style="-fx-font-size: 24px;"/>
                <VBox>
                    <Label fx:id="lblUsername" text="NgÆ°á»i dÃ¹ng" styleClass="sidebar-user-name"/>
                    <Label text="Pro Account" styleClass="sidebar-user-email"/>
                </VBox>
            </HBox>
        </VBox>
    </VBox>

    <!-- ==================== CENTER - NOTES LIST (1/5) ==================== -->
    <VBox styleClass="content-area" minWidth="200" maxWidth="280">
        <!-- Header -->
        <VBox spacing="4" style="-fx-padding: 0 0 15 0;">
            <Label fx:id="lblContentTitle" text="Ghi chÃº" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #2d3748;"/>
            <Label fx:id="lblNotesCount" text="0 ghi chÃº" style="-fx-font-size: 13px; -fx-text-fill: #64748b;"/>
            <HBox alignment="CENTER_LEFT" spacing="5">
                <ComboBox fx:id="cmbSort" promptText="Sáº¯p xáº¿p" style="-fx-font-size: 12px;"/>
            </HBox>
        </VBox>

        <!-- Create Note Button -->
        <Button fx:id="btnCreateNote" text="âœ¨ Táº¡o ghi chÃº má»›i" styleClass="btn-primary" onAction="#handleCreateNote" maxWidth="Infinity" style="-fx-padding: 12 20;"/>

        <!-- Notes List -->
        <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" style="-fx-background-color: transparent; -fx-background: transparent;">
            <VBox fx:id="vboxNotesList" spacing="10" style="-fx-padding: 10 5;">
                <!-- Notes will be loaded dynamically -->
            </VBox>
        </ScrollPane>
    </VBox>

    <!-- ==================== RIGHT - EDITOR PANEL (3/5) ==================== -->
    <VBox fx:id="editorPanel" minWidth="450" styleClass="content-area" style="-fx-border-color: #e2e8f0; -fx-border-width: 0 0 0 1;">
        <HBox.hgrow>ALWAYS</HBox.hgrow>

        <!-- Editor Header -->
        <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-padding: 0 0 10 0;">
            <VBox HBox.hgrow="ALWAYS">
                <Label fx:id="lblEditorTitle" text="Soáº¡n tháº£o ghi chÃº" styleClass="content-title" style="-fx-font-size: 18px;"/>
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label fx:id="lblNoteDate" text="" style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
                    <Label fx:id="lblSaveStatus" text="" style="-fx-text-fill: #10b981; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                </HBox>
            </VBox>

            <!-- Action Buttons -->
            <HBox spacing="8" alignment="CENTER">
                <Button fx:id="btnAiAssistant" text="ðŸ¤–" styleClass="toolbar-btn-lg" onAction="#handleShowAIAssistant">
                    <tooltip><Tooltip text="AI Assistant: TÃ³m táº¯t, TiÃªu Ä‘á», Tag"/></tooltip>
                </Button>

                <Button fx:id="btnFavorite" text="â˜†" styleClass="toolbar-btn-favorite" onAction="#handleToggleFavorite" style="-fx-font-size: 18px;"/>
                <Button fx:id="btnChangeStatus" text="ðŸ“Š" styleClass="toolbar-btn-lg" onAction="#handleChangeStatus"/>
                <Button fx:id="btnDelete" text="   " styleClass="toolbar-btn-lg, toolbar-btn-danger" onAction="#handleDeleteNote">
                   <graphic>
                        <HBox spacing="3" alignment="CENTER">
                            <!-- Trash Icon -->
                            <SVGPath content="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" styleClass="trash-icon-danger" scaleX="0.9" scaleY="0.9"/>
                            <!-- Note Icon -->
                            <SVGPath content="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" styleClass="trash-icon-danger" scaleX="0.75" scaleY="0.75"/>
                        </HBox>
                   </graphic>
                </Button>
            </HBox>
        </HBox>

        <!-- Title Input -->
        <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
            <Label text="TiÃªu Ä‘á»:" style="-fx-font-weight: bold; -fx-text-fill: #374151;"/>
            <TextField fx:id="txtNoteTitle" promptText="Nháº­p tiÃªu Ä‘á» ghi chÃº..." HBox.hgrow="ALWAYS" style="-fx-font-size: 16px; -fx-padding: 10; -fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #d1d5db;"/>
        </HBox>

        <!-- Status Badge -->
        <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
            <Label text="Tráº¡ng thÃ¡i:" style="-fx-font-weight: bold; -fx-text-fill: #374151;"/>
            <Label fx:id="lblStatus" text="REGULAR" styleClass="status-badge"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="MÃ u:" style="-fx-text-fill: #6b7280;"/>
            <HBox fx:id="colorPicker" spacing="5">
                <!-- Color buttons will be added dynamically -->
            </HBox>
        </HBox>



        <!-- ==================== HTML EDITOR ==================== -->
        <!-- ÄÃ¢y lÃ  pháº§n quan trá»ng: HTMLEditor thay cho TextArea -->
        <HTMLEditor fx:id="htmlEditor" VBox.vgrow="ALWAYS" prefHeight="350" minHeight="250" style="-fx-border-color: #e5e7eb; -fx-border-radius: 8;"/>

        <!-- Quick Actions -->
        <HBox spacing="15" alignment="CENTER" style="-fx-padding: 15 0 0 0;">
            <Button text="ðŸ¤– Trá»£ lÃ½" styleClass="btn-primary" onAction="#handleShowAIAssistant" prefWidth="150" prefHeight="38" style="-fx-background-color: linear-gradient(to right, #805ad5, #718096);"/>
            <Button text="ðŸ’¾ LÆ°u ngay" styleClass="btn-outline" onAction="#handleSaveNote" prefWidth="130" prefHeight="38"/>
            <Button text="ðŸ“‹ Sao chÃ©p" styleClass="btn-outline" onAction="#handleCopyContent" prefWidth="130" prefHeight="38"/>
            <Button text="ðŸ“¤ Xuáº¥t file" styleClass="btn-outline" onAction="#handleExportNote" prefWidth="130" prefHeight="38"/>
        </HBox>

        <!-- Keyboard Shortcuts Hint -->
        <HBox alignment="CENTER" style="-fx-padding: 10 0 0 0;">
            <Label text="ðŸ’¡ Ctrl+N: Táº¡o má»›i | Ctrl+B: In Ä‘áº­m | Ctrl+I: In nghiÃªng | Auto-save sau 1.5 giÃ¢y" style="-fx-text-fill: #9ca3af; -fx-font-size: 11px;"/>
        </HBox>
    </VBox>
</HBox>
